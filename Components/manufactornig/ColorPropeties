import React from "react";
import { Card, CardContent, CardHeader, CardTitle } from "@/components/ui/card";
import { Select, SelectContent, SelectItem, SelectTrigger, SelectValue } from "@/components/ui/select";
import { Button } from "@/components/ui/button";
import { Save, Palette } from "lucide-react";
import { motion } from "framer-motion";

export default function ColorProperties({ colorProperties, availableProperties, onPropertiesChange, onSave }) {
  const defaultProperties = [
    "Osseointegration",
    "No tissue adhesion", 
    "Antibacterial",
    "Anti-inflammatory",
    "Biocompatible",
    "Corrosion resistant"
  ];

  const properties = availableProperties.length > 0 ? availableProperties : defaultProperties;

  const handlePropertyChange = (color, property) => {
    onPropertiesChange({
      ...colorProperties,
      [color]: property
    });
  };

  const colorCount = Object.keys(colorProperties).length;

  return (
    <Card className="glass-morphism professional-shadow">
      <CardHeader className="pb-4">
        <CardTitle className="flex items-center gap-2 text-slate-900">
          <Palette className="w-5 h-5 text-purple-600" />
          Color Properties Assignment
        </CardTitle>
      </CardHeader>
      <CardContent>
        {colorCount > 0 ? (
          <div className="space-y-4">
            <p className="text-sm text-slate-600 mb-4">
              Assign functional properties to each detected color on your 3D model. 
              These properties will determine the manufacturing process requirements.
            </p>
            
            {Object.entries(colorProperties).map(([color, property], index) => (
              <motion.div
                key={color}
                initial={{ opacity: 0, x: -20 }}
                animate={{ opacity: 1, x: 0 }}
                transition={{ delay: index * 0.1 }}
                className="flex items-center gap-4 p-4 bg-slate-50 rounded-lg border"
              >
                <div className="flex items-center gap-3">
                  <div
                    className="w-8 h-8 rounded-full border-2 border-slate-300 shadow-sm"
                    style={{ backgroundColor: color }}
                  />
                  <code className="text-sm font-mono text-slate-600 bg-white px-2 py-1 rounded border">
                    {color}
                  </code>
                </div>
                
                <div className="flex-1">
                  <Select
                    value={property || ""}
                    onValueChange={(value) => handlePropertyChange(color, value)}
                  >
                    <SelectTrigger>
                      <SelectValue placeholder="Select property..." />
                    </SelectTrigger>
                    <SelectContent>
                      <SelectItem value={null}>No property</SelectItem>
                      {properties.map((prop) => (
                        <SelectItem key={prop} value={prop}>
                          {prop}
                        </SelectItem>
                      ))}
                    </SelectContent>
                  </Select>
                </div>
              </motion.div>
            ))}

            <div className="pt-4 border-t">
              <Button
                onClick={onSave}
                className="w-full bg-purple-600 hover:bg-purple-700 text-white font-medium py-3"
              >
                <Save className="w-4 h-4 mr-2" />
                Save Properties & Generate Process Chain
              </Button>
              <p className="text-xs text-slate-500 mt-2 text-center">
                This will send the selected properties to the scheduler to optimize your manufacturing process
              </p>
            </div>
          </div>
        ) : (
          <div className="text-center py-8">
            <Palette className="w-12 h-12 text-slate-300 mx-auto mb-4" />
            <p className="text-slate-500 mb-2">No colors detected</p>
            <p className="text-sm text-slate-400">
              Upload and load a 3D model to begin color-property assignment
            </p>
          </div>
        )}
      </CardContent>
    </Card>
  );
}